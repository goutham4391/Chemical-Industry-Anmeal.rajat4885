/**
 * Premium Stock Market Widgets
 * ---------------------------------------------
 * Version 1.8.7, built on Thursday, March 15, 2018
 * Copyright (c) Financial apps and plugins <info@financialplugins.com>. All rights reserved.
 * Demo: https://financialplugins.com/products/premium-stock-market-widgets
 * Purchase: https://codecanyon.net/item/premium-stock-market-widgets/18686543?ref=financialtechnology
 * Like: https://www.facebook.com/financialplugins/
 */
"use strict";var premiumStockMarketWidgetsPlugin=function(e){function a(a){return m=e(document),p=e(g),f("Initialize",p.length+" widgets"),y=e.Deferred(),h=e.Deferred(),e.when(y,h).done(function(){p.trigger("psmwReadyGlobal")}),0!=p.length&&(l(p),m.off("psmwReadyGlobal",g).off("mouseenter",g+" .smw-combo table tbody tr"),m.on("psmwReadyGlobal",g,i).on("click",".smw-modal-close",function(){e(this).closest(".smw-modal").hide()}),void t(p,a))}function t(a,t){n(a);var t="undefined"==typeof t||t,o=r(a),i=[],l=[],d=[],c=e(),u=e(),m=e();a.each(function(a,t){var r=e(t),s=r.data("symbol"),n=r.data("source"),o=r.data("type");if("live"==n){c=c.add(r);for(var f=s?s.split(","):[],p=0;p<f.length;p++)e.inArray(f[p],i)<0&&i.push(f[p])}else"history"==n&&("spark"==o?(l.push(s),u=u.add(r)):"chart"==o&&(d.push(s),m=m.add(r)))});var p=l.length,y=d.length;A+=p+y+(i.length?1:0),f("Number of AJAX calls to make",A);for(var h=0;h<p;h++){var v=u.eq(h);s(v,{source:"history",symbols:l[h].split(","),type:"spark"},t)}for(var h=0;h<y;h++){var g=m.eq(h);s(g,{source:"history",symbols:d[h].split(","),type:"chart",chart_range:g.data("range"),chart_interval:g.data("interval")},t)}i.length&&o.length&&s(c,{source:"live",symbols:i,fields:o},t)}function r(a){var t=[];return a.find(b).each(function(a,r){var r=e(r).data("field").replace("_","");e.inArray(r,t)<0&&t.push(r)}),t}function s(a,t,r,s){r?(f("Get market data from SERVER",t.source,t),e.isEmptyObject(t)||e.ajax({method:smwGlobals.ajaxMethod,url:smwGlobals.ajaxUrl,dataType:"json",cache:!1,context:{source:t.source,symbol:t.symbols,$widgetContainers:a},data:{params:t},success:function(a){f("Market data received",this.source,a),A--,a.success?(e.extend(!0,M,a.data),f("Market data cached",M),"function"==typeof t.callback?t.callback():o(this.$widgetContainers,M)):f("ERROR response received",a.data)}})):(f("Get market data from CACHE",t.source,t),A--,o(a,M))}function n(a){a.each(function(a,t){var r=e(t).data("dependency");if(r){r=r.split(",");for(var s=0;s<r.length;s++)e.inArray(r[s],x)<0&&x.push(r[s])}});var t=x.length;if(t>G)for(var r=0;r<t;r++){var s=smwGlobals.dependencies[x[r]];"undefined"==typeof C[s]&&(f("Loading JS file",s),C[s]=e.ajax({url:s,dataType:"script",cache:!0}).done(function(){G++,f("JS file loaded",s),G==x.length&&(f("All plugins loaded"),h.resolve())}))}else h.resolve()}function o(a,t){a.each(function(a,r){var s=e(r);s.find(b).each(function(a,r){var n=e(r),o=n.data("field"),i=n.data("symbol")?n.data("symbol"):s.data("symbol"),l="undefined"!=typeof t[i]&&"undefined"!=typeof t[i][o]?t[i][o]:"";n.addClass("smw-field-"+o.replace(".","-")),["virtual.symbolLink","virtual.nameLink"].indexOf(o)===-1?n.text(l):n.html(l);var d=n.data("previous-value");"undefined"!=typeof d&&d!=l&&n.animate({opacity:0},200).animate({opacity:1},200).animate({opacity:0},200).animate({opacity:1},200),n.data("previous-value",l)}),s.find(w).each(function(a,r){var n=e(r),o=n.data("symbol")?n.data("symbol"):s.data("symbol"),i="undefined"!=typeof t[o]&&"undefined"!=typeof t[o]["quote.regularMarketChange"]?parseFloat(t[o]["quote.regularMarketChange"]):0;i>0?n.removeClass("smw-drop").addClass("smw-rise"):i<0?n.removeClass("smw-rise").addClass("smw-drop"):n.removeClass("smw-drop smw-rise")})}),0==A&&(f("All AJAX requests completed"),y.resolve())}function i(a){if(a.target){var t=e(a.target);f("psmwReadyGlobal",t.attr("id"),t.attr("class")),t.hasClass("smw-visible")||t.addClass("smw-visible")}}function l(e){e.each(function(e,a){var t=a.className.split(/\s+/);t.length>=3&&d(smwGlobals.pluginUrl+"templates/"+t[1].substr(4)+"/"+t[2].substr(4)+"/style.css")})}function d(a){e.inArray(a,k)<0&&(f("Loading CSS file",a),e("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:a}),k.push(a))}function c(e,a){var t=parseFloat(e.replace(/[^0-9.-]/g,"")),r=parseFloat(a.replace(/[^0-9.-]/g,""));return e&&a&&!isNaN(t)&&!isNaN(r)?t>r?1:t<r?-1:0:e.localeCompare(a)}function u(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0}function f(){0!=smwGlobals.debug&&console.log("PSMW",arguments)}f("globals",smwGlobals);var m,p,y,h,v=smwGlobals.code,g="."+v,b="."+v+"-market-data-field",w="."+v+"-change-indicator",k=[],C={},x=[],G=0,A=0,M={};return e(document).ready(function(){a(!0)}),"undefined"==typeof Number.prototype.formatNumber&&(Number.prototype.formatNumber=function(){var e="undefined"!=typeof arguments[0]?arguments[0]:2,a="undefined"!=typeof arguments[1]?arguments[1]:"en-US";return this.toLocaleString(a,{minimumFractionDigits:e,maximumFractionDigits:e})}),{init:a,getMarketData:function(){return M},getWidgetsFields:r,retrieveMarketData:s,tablesortCompare:c,checkIE:u,log:f}}(jQuery);